// This file is automatically generated, so please do not edit it.
// @generated by `flutter_rust_bridge`@ 2.11.1.

// ignore_for_file: invalid_use_of_internal_member, unused_import, unnecessary_import

import '../frb_generated.dart';
import 'package:flutter_rust_bridge/flutter_rust_bridge_for_generated.dart';

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XdsaFingerprint>>
abstract class XdsaFingerprint implements RustOpaqueInterface {
  /// Creates a fingerprint from a 32-byte array.
  static XdsaFingerprint fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXdsaXdsaFingerprintFromBytes(bytes: bytes);

  /// Serializes the fingerprint to a 32-byte array.
  Uint8List toBytes();
}

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XdsaPublicKey>>
abstract class XdsaPublicKey implements RustOpaqueInterface {
  /// Returns a 32-byte fingerprint uniquely identifying this key.
  XdsaFingerprint fingerprint();

  /// Creates a public key from a 1984-byte array.
  static XdsaPublicKey fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXdsaXdsaPublicKeyFromBytes(bytes: bytes);

  /// Parses a public key from a DER-encoded certificate, verifying the signature.
  /// Returns the key along with validity start and end timestamps (Unix seconds).
  static (XdsaPublicKey, BigInt, BigInt) fromCertDer({
    required List<int> der,
    required XdsaPublicKey signer,
  }) => RustLib.instance.api.crateApiXdsaXdsaPublicKeyFromCertDer(
    der: der,
    signer: signer,
  );

  /// Parses a public key from a PEM-encoded certificate, verifying the signature.
  /// Returns the key along with validity start and end timestamps (Unix seconds).
  static (XdsaPublicKey, BigInt, BigInt) fromCertPem({
    required String pem,
    required XdsaPublicKey signer,
  }) => RustLib.instance.api.crateApiXdsaXdsaPublicKeyFromCertPem(
    pem: pem,
    signer: signer,
  );

  /// Parses a DER-encoded public key.
  static XdsaPublicKey fromDer({required List<int> der}) =>
      RustLib.instance.api.crateApiXdsaXdsaPublicKeyFromDer(der: der);

  /// Parses a PEM-encoded public key.
  static XdsaPublicKey fromPem({required String pem}) =>
      RustLib.instance.api.crateApiXdsaXdsaPublicKeyFromPem(pem: pem);

  /// Serializes the public key to a 1984-byte array.
  Uint8List toBytes();

  /// Generates a DER-encoded X.509 certificate for this public key,
  /// signed by the given xDSA secret key with the specified validity period.
  ///
  /// - `signer`: The xDSA secret key to sign the certificate
  /// - `subject_name`: The subject's common name (CN)
  /// - `issuer_name`: The issuer's common name (CN)
  /// - `not_before`: Certificate validity start time (Unix timestamp)
  /// - `not_after`: Certificate validity end time (Unix timestamp)
  /// - `is_ca`: Whether this is a CA certificate
  /// - `path_len`: Maximum intermediate CAs allowed (only if is_ca is true)
  Uint8List toCertDer({
    required XdsaSecretKey signer,
    required String subjectName,
    required String issuerName,
    required BigInt notBefore,
    required BigInt notAfter,
    required bool isCa,
    int? pathLen,
  });

  /// Generates a PEM-encoded X.509 certificate for this public key,
  /// signed by the given xDSA secret key with the specified validity period.
  ///
  /// - `signer`: The xDSA secret key to sign the certificate
  /// - `subject_name`: The subject's common name (CN)
  /// - `issuer_name`: The issuer's common name (CN)
  /// - `not_before`: Certificate validity start time (Unix timestamp)
  /// - `not_after`: Certificate validity end time (Unix timestamp)
  /// - `is_ca`: Whether this is a CA certificate
  /// - `path_len`: Maximum intermediate CAs allowed (only if is_ca is true)
  String toCertPem({
    required XdsaSecretKey signer,
    required String subjectName,
    required String issuerName,
    required BigInt notBefore,
    required BigInt notAfter,
    required bool isCa,
    int? pathLen,
  });

  /// Serializes the public key to DER format.
  Uint8List toDer();

  /// Serializes the public key to PEM format.
  String toPem();

  /// Verifies a signature against a message.
  void verify({required List<int> message, required XdsaSignature signature});
}

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XdsaSecretKey>>
abstract class XdsaSecretKey implements RustOpaqueInterface {
  /// Returns a 32-byte fingerprint uniquely identifying this key.
  XdsaFingerprint fingerprint();

  /// Creates a private key from a 64-byte seed.
  static XdsaSecretKey fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXdsaXdsaSecretKeyFromBytes(bytes: bytes);

  /// Parses a DER-encoded private key.
  static XdsaSecretKey fromDer({required List<int> der}) =>
      RustLib.instance.api.crateApiXdsaXdsaSecretKeyFromDer(der: der);

  /// Parses a PEM-encoded private key.
  static XdsaSecretKey fromPem({required String pem}) =>
      RustLib.instance.api.crateApiXdsaXdsaSecretKeyFromPem(pem: pem);

  /// Generates a new random private key.
  static XdsaSecretKey generate() =>
      RustLib.instance.api.crateApiXdsaXdsaSecretKeyGenerate();

  /// Returns the public key corresponding to this private key.
  XdsaPublicKey publicKey();

  /// Signs a message, returning a composite signature.
  XdsaSignature sign({required List<int> message});

  /// Serializes the private key to a 64-byte seed.
  Uint8List toBytes();

  /// Serializes the private key to DER format.
  Uint8List toDer();

  /// Serializes the private key to PEM format.
  String toPem();
}

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XdsaSignature>>
abstract class XdsaSignature implements RustOpaqueInterface {
  /// Creates a signature from a 3373-byte array.
  static XdsaSignature fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXdsaXdsaSignatureFromBytes(bytes: bytes);

  /// Serializes the signature to a 3373-byte array.
  Uint8List toBytes();
}
