// This file is automatically generated, so please do not edit it.
// @generated by `flutter_rust_bridge`@ 2.11.1.

// ignore_for_file: invalid_use_of_internal_member, unused_import, unnecessary_import

import '../frb_generated.dart';
import 'package:flutter_rust_bridge/flutter_rust_bridge_for_generated.dart';
import 'xdsa.dart';

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XhpkeFingerprint>>
abstract class XhpkeFingerprint implements RustOpaqueInterface {
  /// Creates a fingerprint from a 32-byte array.
  static XhpkeFingerprint fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXhpkeXhpkeFingerprintFromBytes(bytes: bytes);

  /// Serializes the fingerprint to a 32-byte array.
  Uint8List toBytes();

  /// Returns the fingerprint as a hex string.
  String toHex();
}

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XhpkePublicKey>>
abstract class XhpkePublicKey implements RustOpaqueInterface {
  /// Returns a 32-byte fingerprint uniquely identifying this key.
  XhpkeFingerprint fingerprint();

  /// Creates a public key from a 1216-byte array.
  static XhpkePublicKey fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXhpkeXhpkePublicKeyFromBytes(bytes: bytes);

  /// Parses a public key from a DER-encoded certificate, verifying the xDSA signature.
  /// Returns the key along with validity start and end timestamps (Unix seconds).
  static (XhpkePublicKey, BigInt, BigInt) fromCertDer({
    required List<int> der,
    required XdsaPublicKey signer,
  }) => RustLib.instance.api.crateApiXhpkeXhpkePublicKeyFromCertDer(
    der: der,
    signer: signer,
  );

  /// Parses a public key from a PEM-encoded certificate, verifying the xDSA signature.
  /// Returns the key along with validity start and end timestamps (Unix seconds).
  static (XhpkePublicKey, BigInt, BigInt) fromCertPem({
    required String pem,
    required XdsaPublicKey signer,
  }) => RustLib.instance.api.crateApiXhpkeXhpkePublicKeyFromCertPem(
    pem: pem,
    signer: signer,
  );

  /// Parses a DER-encoded public key.
  static XhpkePublicKey fromDer({required List<int> der}) =>
      RustLib.instance.api.crateApiXhpkeXhpkePublicKeyFromDer(der: der);

  /// Parses a PEM-encoded public key.
  static XhpkePublicKey fromPem({required String pem}) =>
      RustLib.instance.api.crateApiXhpkeXhpkePublicKeyFromPem(pem: pem);

  /// Encrypts a message to this public key.
  ///
  /// Returns a tuple of (1120-byte session key, ciphertext).
  ///
  /// - `msg_to_seal`: The plaintext to encrypt
  /// - `msg_to_auth`: Additional authenticated data (not encrypted)
  /// - `domain`: Application-specific domain separator
  (Uint8List, Uint8List) seal({
    required List<int> msgToSeal,
    required List<int> msgToAuth,
    required List<int> domain,
  });

  /// Serializes the public key to a 1216-byte array.
  Uint8List toBytes();

  /// Generates a DER-encoded X.509 certificate for this public key,
  /// signed by the given xDSA secret key with the specified validity period.
  ///
  /// - `signer`: The xDSA secret key to sign the certificate
  /// - `subject_name`: The subject's common name (CN)
  /// - `issuer_name`: The issuer's common name (CN)
  /// - `not_before`: Certificate validity start time (Unix timestamp)
  /// - `not_after`: Certificate validity end time (Unix timestamp)
  /// - `is_ca`: Whether this is a CA certificate
  /// - `path_len`: Maximum intermediate CAs allowed (only if is_ca is true)
  Uint8List toCertDer({
    required XdsaSecretKey signer,
    required String subjectName,
    required String issuerName,
    required BigInt notBefore,
    required BigInt notAfter,
    required bool isCa,
    int? pathLen,
  });

  /// Generates a PEM-encoded X.509 certificate for this public key,
  /// signed by the given xDSA secret key with the specified validity period.
  ///
  /// - `signer`: The xDSA secret key to sign the certificate
  /// - `subject_name`: The subject's common name (CN)
  /// - `issuer_name`: The issuer's common name (CN)
  /// - `not_before`: Certificate validity start time (Unix timestamp)
  /// - `not_after`: Certificate validity end time (Unix timestamp)
  /// - `is_ca`: Whether this is a CA certificate
  /// - `path_len`: Maximum intermediate CAs allowed (only if is_ca is true)
  String toCertPem({
    required XdsaSecretKey signer,
    required String subjectName,
    required String issuerName,
    required BigInt notBefore,
    required BigInt notAfter,
    required bool isCa,
    int? pathLen,
  });

  /// Serializes the public key to DER format.
  Uint8List toDer();

  /// Serializes the public key to PEM format.
  String toPem();
}

// Rust type: RustOpaqueMoi<flutter_rust_bridge::for_generated::RustAutoOpaqueInner<XhpkeSecretKey>>
abstract class XhpkeSecretKey implements RustOpaqueInterface {
  /// Returns a 32-byte fingerprint uniquely identifying this key.
  XhpkeFingerprint fingerprint();

  /// Creates a private key from a 32-byte seed.
  static XhpkeSecretKey fromBytes({required List<int> bytes}) =>
      RustLib.instance.api.crateApiXhpkeXhpkeSecretKeyFromBytes(bytes: bytes);

  /// Parses a DER-encoded private key.
  static XhpkeSecretKey fromDer({required List<int> der}) =>
      RustLib.instance.api.crateApiXhpkeXhpkeSecretKeyFromDer(der: der);

  /// Parses a PEM-encoded private key.
  static XhpkeSecretKey fromPem({required String pem}) =>
      RustLib.instance.api.crateApiXhpkeXhpkeSecretKeyFromPem(pem: pem);

  /// Generates a new random private key.
  static XhpkeSecretKey generate() =>
      RustLib.instance.api.crateApiXhpkeXhpkeSecretKeyGenerate();

  /// Decrypts a message that was encrypted to this key's public counterpart.
  ///
  /// - `session_key`: The 1120-byte encapsulated session key
  /// - `msg_to_open`: The ciphertext to decrypt
  /// - `msg_to_auth`: Additional authenticated data (not encrypted)
  /// - `domain`: Application-specific domain separator
  Uint8List open({
    required List<int> sessionKey,
    required List<int> msgToOpen,
    required List<int> msgToAuth,
    required List<int> domain,
  });

  /// Returns the public key corresponding to this private key.
  XhpkePublicKey publicKey();

  /// Serializes the private key to a 32-byte seed.
  Uint8List toBytes();

  /// Serializes the private key to DER format.
  Uint8List toDer();

  /// Serializes the private key to PEM format.
  String toPem();
}
